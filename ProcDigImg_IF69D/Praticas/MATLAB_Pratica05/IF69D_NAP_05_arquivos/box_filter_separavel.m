% box_filter_separavel [script]

clc, clear, close all

g = imread('cameraman.tif');
g = double(g);

[nr nc] = size(g);

mask = [1/25 1/25 1/25 1/25 1/25;...
        1/25 1/25 1/25 1/25 1/25;...
        1/25 1/25 1/25 1/25 1/25;...
        1/25 1/25 1/25 1/25 1/25;...
        1/25 1/25 1/25 1/25 1/25];

% 5x5 box filter (25 coeficientes)
gf = zeros(nr,nc);
tic
for i = 3 : nr-3
  for j = 3 : nc-3
    gf(i,j)  =  mask(1,1)*g(i-2,j-2) + mask(1,2)*g(i-2,j-1) + ...
                mask(1,3)*g(i-2,j) + ...
                mask(1,4)*g(i-2,j+1) + mask(1,5)*g(i-2,j+2) + ...
                mask(2,1)*g(i-1,j-2) + mask(2,2)*g(i-1,j-1) + ...
                mask(2,3)*g(i-1,j) + ...
                mask(2,4)*g(i,j+1) + mask(2,5)*g(i,j+2) + ...
                mask(3,1)*g(i,j-2) + mask(3,2)*g(i,j-1) + ...
                mask(3,3)*g(i,j) + ...
                mask(3,4)*g(i,j+1) + mask(3,5)*g(i,j+2) + ...
                mask(4,1)*g(i+1,j-2) + mask(4,2)*g(i+1,j-1) + ...
                mask(4,3)*g(i+1,j) + ...
                mask(4,4)*g(i+1,j+1) + mask(4,5)*g(i+1,j+2) + ...
                mask(5,1)*g(i+2,j-2) + mask(5,2)*g(i+2,j-1) + ...
                mask(5,3)*g(i+2,j) + ...
                mask(5,4)*g(i+2,j+1) + mask(5,5)*g(i+2,j+2);    
  end
end
filtro_5por5 = toc


masksx = [1/5 1/5 1/5 1/5 1/5];
masksy = masksx';

% 5x5 box filter separ√°vel (10 coeficientes)
gfsx = zeros(nr,nc);
gfs = zeros(nr,nc);
tic
for i = 1 : nr
  for j = 3 : nc-3
    gfsx(i,j) = masksx(1,1)*g(i,j-2) + masksx(1,2)*g(i,j-1) + ...
                masksx(1,3)*g(i,j) + ...
                masksx(1,4)*g(i,j+1) + masksx(1,5)*g(i,j+2);
  end
end
for i = 3 : nr-3
  for j = 1 : nc
    gfs(i,j) =  masksy(1,1)*gfsx(i-2,j) + masksy(2,1)*gfsx(i-1,j) + ...
                masksy(3,1)*gfsx(i,j) + ...
                masksy(4,1)*gfsx(i+1,j) + masksy(5,1)*gfsx(i+2,j);
  end
end
filtro_sep = toc

filtro_5por5/filtro_sep

g = uint8(g);
gf = uint8(gf);
gfs = uint8(gfs);

figure, imshow(g), title('orig')
figure, imshow(gf), title('5x5')
figure, imshow(gfs), title('5x5 separavel')